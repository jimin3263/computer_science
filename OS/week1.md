## 1.1 What Operating Systems Do

### 사용자 관점

|사용자|사용자의 특징|특징|
|------|---|---|
|PC|개인이 사용|사용자 자원 독점, 효율성 상관 없음, 사용 편의성 제공|
|Mainframe, Minicomputer|여러 사람 공유|효율적 관리|
|Workstations|네트워크를 통해 서버 연결|사용 편의성 + 자원의 효율적 관리 |
|Handheld Computer|들고 다님|배터리 등 모바일에 최적화|
|Embedded|기계등 내장, 비교적 간단|사용자 인터페이스 필요 없음|

### 컴퓨터 시스템 관점

- Resource allocator
  - 자원에 대한 관리자, 응용 프로그램이 문제를 해결하기 위해 자원 할당해줌
 - Control program
  - 응용프로그램 실행할 수 있게 해줌
  - 사용자 인터페이스 제공(사용자가 원하는 프로그램 쉽게 실행할 수 있도록)
  - 오류, 부적절한 실행 방지를 위해 제어
  - 입출력 장치에 깊이 관여함

### 운영체제

- 다양한 응용 프로그램들이 공통으로 필요하는 입출력 연산, 자원 제어, 할당 공통 기능을 하나의 소프트웨어 통합하는 과정에서 운영체제 
- 운영체제를 설치한 직후 컴퓨터 시스템에 담겨지는 모든것
- windows -> 기본적으로 있는 메모장도 ..?
- kernel: 컴퓨터가 동작되는동안 항상 실행 
- 패키지에 포함되는 내용 중 운영체제의 일부, 커널에 포함될 필요없는 운영체제 -> 시스템 프로그램
- 시스템 프로그램에 관계없는 나머지 프로그램 -> 응용 프로그램
- 운영체제 = kernel
- 컴퓨터 사용자 - 하드웨어 사이에서 중간 역할
  - 운영체제의 목표: 사용자 프로그램 실행, 컴퓨터 시스템을 편리하게 사용, 컴퓨터 하드웨어가 효율적으로 사용됨  

<br>

## 1.2 Computer System Structure

- 운영체제는 하드웨어와 밀접한 연관
- 컴퓨터 시스템 -> 하드웨어, 운영체제, 응용 프로그램, 사용자
- 하드웨어: 컴퓨팅 자원 (CPU, memory, I/O device)
  - CPU: 프로그램/ 프로그램을 이루고 있는 명령 실행
  - main memory: 프로그램이 실행되는 동안 이를 저장하는 장치
  - I/O device: CPU, main memory 제외한 모든것 / 컴퓨터 외부와 데이터를 주고 받거나 데이터 보관
  - CPU-memory / 입출력장치-memory -> bus로 연결 - CPU, 입출력 장치는 memory를 대상으로 경쟁하는 관계  
- 응용프로그램: 사용자의 문제해결 도움, 하드웨어 사용 주체 -> 워드프로세서, 웹 브라우저 등
- 사용자: 컴퓨터 사용, 한 컴퓨터가 다른 컴퓨터 사용할 수도, 서버(클라이언트)  

**-> 사용자는 특정 응용프로그램을 실행함으로써 문제해결을 하고 응용프로그램은 실행을 위해 자원이 필요한데, 운영체제를 통해 응용프로그램은 원하는 자원을 얻을 수 있다**
<br>

- I/O devices 와 CPU 는 독립적으로 동작 -> CPU 명령 시행, 입출력 장치는 입출력 연산
- controller: 입출력 중인 데이터 임시보관하는 로컬 버퍼 가짐 (CPU의 레지스터와 유사)
  - 입력 -> 로컬버퍼 -> 메인메모리
  - 메인메모리 -> 로컬버퍼 -> 출력
- CPU는 메인메모리와 레지스터 간의 데이터 이동
- 입출력 장치는 메인메모리와 입출력 장치의 레지스터인 local buffer간의 데이터 이동
- 위의 두가지 동작은 독립적, 이들간의 동작 동기화 필요하기도
- 입출력 장치가 진행하던 입출력 완료 -> 입출력 장치는 입출력 완료를 interrupt을 통해서 CPU에게 알림  

### Interrupt
- CPU는 동작하는 중에 입출력 장치로부터 신호를 받음 
- 하던 일을 멈추고 해당 interrupt 처리
- interrupt 벡터 이용 -> interrupt의 유형을 나타내는 고유 숫자(운영체제의 자료구조)
- 운영체제는 interrupt 처리 함수(운영체제 코드 일부)의 시작 주소 가짐
- interrupt 처리함수: 인터럽트 발생시 CPU가 해야하는 일 미리 정의
- interrupt 처리함수 -> 운영체제 코드 일부, 실행된다 : 실행제어가 운영체제로 넘어감
- interrupt 처리함수 종료 -> interrupt 발생하던 시점으로 돌아가야함(interrupt 발생하면 그 시점의 주소 저장)
- 외부 interrupt:입출력 관련 interrupt
- 내부 interrupt (CPU 자체의 동작이 원인이 되어서 발생하는 interrupt): trap, exception
- interrupt driven: interrupt 발생-> 운영체제 동작-> interrupt driven 방식이라고 함 !  
**-> interrupt 발생 지점 저장, 해당 처리 함수 실행, 저장된 지점으로 돌아옴 : 외부, 내부 같은 동작**  

### Interrupt Handling
- interrupt 발생-> 그 상태 보존
  - 인터럽트 발생 시점의 레지스터 값 -> 인터럽트 처리가 끝났을 때 발생 시점의 상황 복원해서 실행 이어감
  - program counter : 수행 지점 저장
- interrupt 구별
  - vector: 장치에서 전달된 벡터를 보고 어느 장치의 인터럽트인지
  - polling: 어느 장치에서 인터럽트를 보냈는지 확인해야 함
- interrupt 처리 함수 실행
  - 발생하는 인터럽트에 따라 운영체제 코드의 각기 다른 부분 실행됨
- Interrupt Timeline
  - 입출력 개시 요청 (실행중인 응용프로그램이 출력 명령, CPU로부터 입출력 장치로부터 입출력 요청)
  - CPU : 입출력 요청 후 자신의 역할 / IO : 해야하는 일 함 -> 병렬 수행 가능
  - 입출력 완료로 인해 interrupt 발생 (입출력 -> CPU)
  - interrupt 보낸 장치 확인, 이에 대한 interrupt 처리함수 실행 : 운영체제 커널 실행
  - 입출력 장치: 다음 지시가 있을 때까지 idle / 처리 끝나고 응용프로그램으로 돌아가 발생직전 하던 일 함

### Storage Structure

- Register: CPU내부의 word 크기/ CPU가 명령 수행할 떄 레지스터 내의 데이터 접근
- cache: CPU 내부 혹은 바로 옆 / CPU가 가장 최근에 접근한 명령이나 데이터의 복사본
- Main memory: CPU가 프로그램 실행하려면 필요, CPU가 접근할 수 있는 유일한 메모리
  - 현재 실행 중인 프로그램 저장
  - 모든 프로그램은 실행되기 위해서 메인메모리에 로드
  - Random access: 데이터가 저장된 위치에 관련없이 속도 일정
  - Volatile: 휘발성
- Secondary Storage(보조저장 장치)
  - magnetic disk: 하드디스크 / 비휘발성 / 원형 금속판+자석물질+데이터 저장
  - ssd: 하드디스크보다 빠름/ 비휘발성/ 플래시 메모리 기반


**-> 위로 갈수록 속도빠름, 단위 용량당 가격이 비쌈, register, cache, main memory까지 휘발성**

- Caching: 저속의 저장장치에 저장되있는 데이터를 일부의 복사본을 빠른 저장장치에 저장, 컴퓨터 동작 성능 향상
  - Main memory -> cache
  - magnetic disk -> Main memory
  - 성능 향상 기법 (컴퓨터 시스템 여러 곳에서 사용)
  - 특정 하드웨어 내, 운영체제 등
  - 주어진 하드웨어 하에서 최대한 빨리 데이터에 접근
  - 고속 저장장치의 용량 < 저속 저장 장치 -> 일부만이 캐싱
  - 가장 최근에 사용한 데이터를 주로 캐싱 -> 가장 최근에 사용한 데이터를 다시 사용할 가능성이 높기 때문
  - 모든 데이터 접근시, 캐쉬 역할을 하는 고속 저장장치부터 뒤져봄 -> 원하는 데이터 캐쉬에 존재할 수도
  - 캐쉬에 있다 -> 성능 향상
  - 캐쉬에 없다 -> 저속 저장장치로 이동 -> 복사한 데이터를 고속 저장 장치에 저장
  - 캐쉬에 저장된 데이터를 새로운 데이터로 갱신: cache replacement


- Device Driver: SSD 이하 -> 입출력 장치  
  - 입출력 전용 프로그램  
  - 이를 통해 운영체제를 저장 장치 특성과 무관하게 일관된 방법으로 데이터에 접근

### I/O Structure 
: CPU 동작 속도, 입출력 장치 속도의 속도 차이 존재하기 때문에 두 가지 방식

- CPU가 입출력 요청, 해당 요청 완료될 때까지 기다림
  - interrupt 발생할 떄까지 idle 명령 반복
  - 한번에 하나의 입출력
- CPU가 입출력 요청 후, 기다리지 않고 자신의 방식 이어감
  - 동시에 여러개의 입출력 병행 가능 -> 내부적으로 device status table를 통해서 각 현재 입출력 상태를 관리함

### DMA - Direct Memory Access Structure
- 일반적 입출력
  - 메모리에 있는 데이터를 프린터 출력 -> CPU가 입출력 명령을 실행해서 한번에 하나씩 입출력 장치로 내보내면서 출력이 이루어짐 (출력할 데이터를 출력장치를 보내는 과정에 CPU 관여)
- 고속 입출력 장치 : DMA 
  - 처음 입출력 개시될때만 CPU 관여, 이후 메모리에 있는 데이터는 관여없이 직접 해당 입출력 장치로 전송되어 출력  
  - CPU 관여없이 Device controller와 main memory간의 블록단위의 데이터 전송
  - Interrupt 발생: 매 바이트마다 발생하지 않고 일련의 블록에 대한 입출력이 완료될 때 한번만 인터럽트 발생

<br>

## 1.3 Computer System Architecture
- Singleprocessors
   - 범용의 명령어 집합을 실행할 수 있는 하나의 CPU
- Multiprocessors (= Parallel systems, multi core system)
  - 두개 이상의 Processor
  - 처리양 증가
  - 비용이 적게 듦
  - 신뢰성 증가 -> 일부 프로세서가 고장나더라도 동작 이어나갈 수 있음
  - Asymmetric Multiprocessing: 한 프로세서가 주 프로세서여서 전체 시스템 제어/ 다른 프로세서들은 주 프로세서의 명령 실행, 미리 지정된 task 시행
  - Symmetric Multiprocessing: 더 일반적/ 각 프로세서가 운영체제와 사용자 프로그램을 동등하게 처리 (SMP) -> 대등
  - UMA: 모든 프로세서에서의 메모리 접근 동일한 시간
  - NUMA: 일부 메모리는 다른 위치에 있는 메모리보다 접근시간 오래 걸림  
  
### multi core
- 하나 칩에 여러개의 core 포함
- 단일 코어를 가진 여러 개의 칩보다 효율적
  - 칩 내의 코어간의 통신이 칩간의 통신보다 빠름
  - 여러 개의 단일 칩보다 전력 소모 적음
  - 두 개의 표준적인 processor를 가지는 multiprocessor 동일하게 보이게 됨
- blade server: 처리기 보드, 입출력 보드, 네트워킹 보드를 하나에 장착
  - 기존 multi processor 와의 차이: 독립적으로 부팅, 자신만의 운영체제 실행  
 

### clustered System

- 둘 이상의 독자적인 computer system이 비교적 고속의 network로 묶여 마치 단일 computer system처럼 동작
- 복수의 시스템
- SAN을 통해 저장 장치 공유
- 고가영성 서비스 제공  
- 고성능 컴퓨팅 환경 제공  
